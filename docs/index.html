<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Void User Repository</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<button class="theme-toggle" onclick="toggleTheme()">üåì</button>
<script>
  function toggleTheme(){
    const html=document.documentElement;
    const current=html.getAttribute("data-theme")||"dark";
    const next=current==="dark"?"light":"dark";
    html.setAttribute("data-theme",next);
    localStorage.setItem("theme",next)
  }
  (function(){
    const saved=localStorage.getItem("theme")||"dark";
    document.documentElement.setAttribute("data-theme",saved)
  })();
</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const toc = document.getElementById("TOC");
    if (!toc) return;

    // Add toc-title with toggle button
    const titleEl = document.createElement("div");
    titleEl.id = "toc-title";
    titleEl.innerHTML = '<span>Contents</span><span id="toc-toggle-icon">‚óÄ</span>';
    toc.insertBefore(titleEl, toc.firstChild);

    // Wrap TOC + the rest of the content in .page-wrapper
    const body = document.body;
    const wrapper = document.createElement("div");
    wrapper.className = "page-wrapper";

    // Find all elements after <nav> (main nav menu)
    const topNav = document.querySelector("body > nav");
    const siblings = [];
    let el = topNav ? topNav.nextElementSibling : body.firstElementChild;
    while (el) {
      siblings.push(el);
      el = el.nextElementSibling;
    }

    siblings.forEach((s) => wrapper.appendChild(s));
    body.appendChild(wrapper);

    // Wrap main content (everything except TOC) in .main-content
    const mainContent = document.createElement("div");
    mainContent.className = "main-content";
    Array.from(wrapper.children).forEach((child) => {
      if (child.id !== "TOC") mainContent.appendChild(child);
    });
    wrapper.appendChild(mainContent);

    // Collapsible toggle
    const icon = document.getElementById("toc-toggle-icon");
    const saved = localStorage.getItem("toc-collapsed");
    if (saved === "true") {
      toc.classList.add("collapsed");
      icon.textContent = "‚ñ∂";
    }

    titleEl.addEventListener("click", function () {
      toc.classList.toggle("collapsed");
      const isCollapsed = toc.classList.contains("collapsed");
      icon.textContent = isCollapsed ? "‚ñ∂" : "‚óÄ";
      localStorage.setItem("toc-collapsed", isCollapsed);
    });
  });
</script>
<nav><ul>
  <li><a href="https://osowoso.org">oSoWoSo</a></li>
  <li><a href="index.html" class="active">Home</a></li>
  <li><a class="no-release" href="https://github.com/oSoWoSo/void-user-repository/releases/latest">‚è¨ release</a></li>
  <li><a href="https://github.com/oSoWoSo/void-user-repository/archive/refs/heads/main.zip">üì¶repo zip</a></li>
  <li><a href="https://github.com/oSoWoSo/void-user-repository">üîógit</a></li>
  <li>‚è≠Ô∏è</a></li>
</ul></nav>
<header id="title-block-header">
<h1 class="title">Void User Repository</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#disclaimer" id="toc-disclaimer">DISCLAIMER</a></li>
<li><a href="#overview" id="toc-overview">Overview</a></li>
<li><a href="#available-packages" id="toc-available-packages">Available
packages</a></li>
<li><a href="#the-vay-script" id="toc-the-vay-script">The
<code>vay</code> script</a></li>
<li><a href="#installation" id="toc-installation">Installation</a></li>
<li><a href="#prebuilt-binaries" id="toc-prebuilt-binaries">Prebuilt
binaries</a></li>
<li><a href="#manually-building" id="toc-manually-building">Manually
building</a>
<ul>
<li><a href="#running-hyprland" id="toc-running-hyprland">Running
Hyprland</a></li>
<li><a href="#contributing" id="toc-contributing">Contributing</a></li>
<li><a href="#credits" id="toc-credits">Credits</a></li>
</ul></li>
</ul>
</nav>
<h2 id="disclaimer">DISCLAIMER</h2>
<p>This project is <strong>not affiliated with or endorsed by the Void
Linux project</strong> or its maintainers. It is an <strong>unofficial
community tool</strong> designed to simplify managing and building
user-contributed packages using the void-packages build system. Use at
your own discretion.</p>
<h2 id="overview">Overview</h2>
<p>A collection of template files for building packages on Void Linux.
Includes a helper script, vay, which simplifies local package building
and installation. If you dont wish to build the packages locally, this
repository also provides prebuilt binaries in the releases. Information
on how to easily download and install them go to <a
href="#prebuilt-binaries">Prebuilt binaries</a>.</p>
<h2 id="available-packages">Available packages</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">package</th>
<th style="text-align: left;">version</th>
<th style="text-align: left;">homepage</th>
<th style="text-align: left;">maintainer</th>
<th style="text-align: left;">notes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">aquamarine</td>
<td style="text-align: left;">0.9.5</td>
<td style="text-align: left;"><a
href="https://github.com/hyprwm/aquamarine">https://github.com/hyprwm/aquamarine</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">btrfs-progs</td>
<td style="text-align: left;">6.17.1</td>
<td style="text-align: left;"><a
href="https://btrfs.wiki.kernel.org/index.php/Main_Page">https://btrfs.wiki.kernel.org/index.php/Main_Page</a></td>
<td style="text-align: left;">Enno</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">glaze</td>
<td style="text-align: left;">6.0.3</td>
<td style="text-align: left;"><a
href="https://github.com/stephenberry/glaze">https://github.com/stephenberry/glaze</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">hyprcursor</td>
<td style="text-align: left;">0.1.13</td>
<td style="text-align: left;"><a
href="https://github.com/hyprwm/hyprcursor">https://github.com/hyprwm/hyprcursor</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">hyprdynamicmonitors</td>
<td style="text-align: left;">1.3.5</td>
<td style="text-align: left;"><a
href="https://github.com/fiffeek/hyprdynamicmonitors">https://github.com/fiffeek/hyprdynamicmonitors</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">hyprgraphics</td>
<td style="text-align: left;">0.3.0</td>
<td style="text-align: left;"><a
href="https://github.com/hyprwm/hyprgraphics">https://github.com/hyprwm/hyprgraphics</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">hypridle</td>
<td style="text-align: left;">0.1.7</td>
<td style="text-align: left;"><a
href="https://github.com/hyprwm/hypridle">https://github.com/hyprwm/hypridle</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">hyprland</td>
<td style="text-align: left;">0.52.1</td>
<td style="text-align: left;"><a
href="https://hyprland.org/">https://hyprland.org/</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">hyprland-guiutils</td>
<td style="text-align: left;">0.1.0</td>
<td style="text-align: left;"><a
href="https://github.com/hyprwm/hyprland-guiutils">https://github.com/hyprwm/hyprland-guiutils</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">hyprland-protocols</td>
<td style="text-align: left;">0.7.0</td>
<td style="text-align: left;"><a
href="https://github.com/hyprwm/hyprland-protocols">https://github.com/hyprwm/hyprland-protocols</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">hyprland-qt-support</td>
<td style="text-align: left;">0.1.0</td>
<td style="text-align: left;"><a
href="https://github.com/hyprwm/hyprland-qt-support">https://github.com/hyprwm/hyprland-qt-support</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">hyprlang</td>
<td style="text-align: left;">0.6.4</td>
<td style="text-align: left;"><a
href="https://github.com/hyprwm/hyprlang">https://github.com/hyprwm/hyprlang</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">hyprlock</td>
<td style="text-align: left;">0.9.2</td>
<td style="text-align: left;"><a
href="https://github.com/hyprwm/hyprlock">https://github.com/hyprwm/hyprlock</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">hyprpaper</td>
<td style="text-align: left;">0.7.6</td>
<td style="text-align: left;"><a
href="https://github.com/hyprwm/hyprpaper">https://github.com/hyprwm/hyprpaper</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">hyprpicker</td>
<td style="text-align: left;">0.4.5</td>
<td style="text-align: left;"><a
href="https://github.com/hyprwm/hyprpicker">https://github.com/hyprwm/hyprpicker</a></td>
<td style="text-align: left;">RAR27</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">hyprpolkitagent</td>
<td style="text-align: left;">0.1.3</td>
<td style="text-align: left;"><a
href="https://github.com/hyprwm/hyprpolkitagent">https://github.com/hyprwm/hyprpolkitagent</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">hyprsunset</td>
<td style="text-align: left;">0.3.3</td>
<td style="text-align: left;"><a
href="https://github.com/hyprwm/hyprsunset">https://github.com/hyprwm/hyprsunset</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">hyprsysteminfo</td>
<td style="text-align: left;">0.1.3</td>
<td style="text-align: left;"><a
href="https://github.com/hyprwm/hyprsysteminfo">https://github.com/hyprwm/hyprsysteminfo</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">hyprtoolkit</td>
<td style="text-align: left;">0.3.0</td>
<td style="text-align: left;"><a
href="https://github.com/hyprwm/hyprtoolkit">https://github.com/hyprwm/hyprtoolkit</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">hyprutils</td>
<td style="text-align: left;">0.10.2</td>
<td style="text-align: left;"><a
href="https://github.com/hyprwm/hyprutils">https://github.com/hyprwm/hyprutils</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">hyprwayland-scanner</td>
<td style="text-align: left;">0.4.5</td>
<td style="text-align: left;"><a
href="https://github.com/hyprwm/hyprwayland-scanner">https://github.com/hyprwm/hyprwayland-scanner</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">libspng</td>
<td style="text-align: left;">0.7.4</td>
<td style="text-align: left;"><a
href="https://libspng.org/">https://libspng.org/</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">linuxcommandlibrary</td>
<td style="text-align: left;">3.3.1</td>
<td style="text-align: left;"><a
href="http://linuxcommandlibrary.com/">http://linuxcommandlibrary.com/</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">ly</td>
<td style="text-align: left;">1.1.2</td>
<td style="text-align: left;"><a
href="https://codeberg.org/fairyglade/ly">https://codeberg.org/fairyglade/ly</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;">i686 x86_64</td>
</tr>
<tr>
<td style="text-align: left;">nebula-gtk</td>
<td style="text-align: left;">1.1.3</td>
<td style="text-align: left;"><a
href="https://github.com/Letdown2491/nebula-gtk">https://github.com/Letdown2491/nebula-gtk</a></td>
<td style="text-align: left;">Letdown2491</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">sdbus-cpp</td>
<td style="text-align: left;">2.1.0</td>
<td style="text-align: left;"><a
href="https://github.com/Kistler-Group/sdbus-cpp">https://github.com/Kistler-Group/sdbus-cpp</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">shattered-pixel-dungeon</td>
<td style="text-align: left;">3.2.5</td>
<td style="text-align: left;"><a
href="https://github.com/00-Evan/shattered-pixel-dungeon">https://github.com/00-Evan/shattered-pixel-dungeon</a></td>
<td style="text-align: left;">Mihail</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">tomlplusplus</td>
<td style="text-align: left;">3.4.0</td>
<td style="text-align: left;"><a
href="https://marzer.github.io/tomlplusplus/">https://marzer.github.io/tomlplusplus/</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">vbm</td>
<td style="text-align: left;">1.0.1</td>
<td style="text-align: left;"><a
href="https://codeberg.org/oSoWoSo/vbm">https://codeberg.org/oSoWoSo/vbm</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">xdg-desktop-portal-hyprland</td>
<td style="text-align: left;">1.3.11</td>
<td style="text-align: left;"><a
href="https://github.com/hyprwm/xdg-desktop-portal-hyprland">https://github.com/hyprwm/xdg-desktop-portal-hyprland</a></td>
<td style="text-align: left;">zenobit</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">zen-browser</td>
<td style="text-align: left;">1.17.4b</td>
<td style="text-align: left;"><a
href="https://www.zen-browser.app/">https://www.zen-browser.app/</a></td>
<td style="text-align: left;">Encoded14</td>
<td style="text-align: left;">x86_64 aarch64</td>
</tr>
<tr>
<td style="text-align: left;">zig</td>
<td style="text-align: left;">0.14.1</td>
<td style="text-align: left;"><a
href="https://ziglang.org">https://ziglang.org</a></td>
<td style="text-align: left;">Orphaned</td>
<td style="text-align: left;">x86_64* aarch64*</td>
</tr>
</tbody>
</table>
<h2 id="the-vay-script">The <code>vay</code> script</h2>
<p><code>vay</code> works similarly to AUR helpers on Arch Linux.
Automatically performs the actions needed to build the packages locally
on your system. If you prefer to do this manually go to <a
href="#manually-building">Manually building</a>. Note: this script not
only works for the extra template files provided in this repository but
also for packages not distrubted in the Voidlinux mirrors such as
nonfree packages (discord, spotify, etc.)</p>
<h2 id="installation">Installation</h2>
<ol type="1">
<li>Start by cloning this repository.</li>
</ol>
<pre><code>git clone https://github.com/oSoWoSo/void-user-repository</code></pre>
<ol start="2" type="1">
<li>Change into the cloned directory:</li>
</ol>
<pre><code>cd void-user-repository</code></pre>
<ol start="3" type="1">
<li>Create <code>~/.local/bin</code> if it doesn‚Äôt already exist:</li>
</ol>
<pre><code>mkdir -p ~/.local/bin</code></pre>
<ol start="4" type="1">
<li>Symlink the helper script:</li>
</ol>
<pre><code>ln -sf &quot;$(realpath vay.sh)&quot; &quot;$HOME/.local/bin/vay&quot;</code></pre>
<ol start="5" type="1">
<li>Run the helper by typing vay followed by one or more package
names:</li>
</ol>
<pre><code>vay &lt;package1&gt; &lt;package2&gt; ...</code></pre>
<h2 id="prebuilt-binaries">Prebuilt binaries</h2>
<p>Currently prebuilt binary packages are provided for the following
architectures:</p>
<ul>
<li>x86_64-glibc</li>
<li>x86_64-musl</li>
<li>aarch64-glibc</li>
<li>aarch64-musl</li>
</ul>
<ol type="1">
<li>Create an entry in /etc/xbps.d/ and add this repository. This can be
done with the following commands:</li>
</ol>
<ul>
<li>x86_64-glibc</li>
</ul>
<pre><code>echo repository=https://github.com/oSoWoSo/VUR-x86_64/raw/refs/heads/bin | sudo tee /etc/xbps.d/00-VUR.conf</code></pre>
<ul>
<li>x86_64-musl</li>
</ul>
<pre><code>echo repository=https://github.com/oSoWoSo/VUR-x86_64-musl/raw/refs/heads/bin | sudo tee /etc/xbps.d/00-VUR.conf</code></pre>
<ul>
<li>aarch64-glibc</li>
</ul>
<pre><code>echo repository=https://github.com/oSoWoSo/VUR-aarch64/raw/refs/heads/bin | sudo tee /etc/xbps.d/00-VUR.conf</code></pre>
<ul>
<li>aarch64-musl</li>
</ul>
<pre><code>echo repository=https://github.com/oSoWoSo/VUR-aarch64-musl/raw/refs/heads/bin | sudo tee /etc/xbps.d/00-VUR.conf</code></pre>
<ol start="2" type="1">
<li>Refresh your repositories and accept the fingerprint:</li>
</ol>
<pre><code>sudo xbps-install -S</code></pre>
<ol start="3" type="1">
<li>You are now able to search through all of the packages in this
repository, and install them as usual:</li>
</ol>
<pre><code>xbps-query -Rs hypr
sudo xbps-install -S hyprland</code></pre>
<h2 id="manually-building">Manually building</h2>
<ol type="1">
<li>Clone both this repository as well as <a
href="https://github.com/void-linux/void-packages">void-packages</a>:</li>
</ol>
<pre><code>git clone https://github.com/oSoWoSo/void-user-repository.git
git clone https://github.com/void-linux/void-packages.git</code></pre>
<ol start="2" type="1">
<li>Copy the templates files from this repository into
void-packages:</li>
</ol>
<pre><code>cp -r void-user-repository/srcpkgs/* void-packages/srcpkgs/</code></pre>
<ol start="3" type="1">
<li><p>Edit shlibs by removing the lines found in shlibs_remove and
appending the lines from shlibs_append.</p></li>
<li><p>Bootstrap the build system:</p></li>
</ol>
<pre><code>cd void-packages
./xbps-src binary-bootstrap</code></pre>
<ol start="5" type="1">
<li>Build the packages you want:</li>
</ol>
<pre><code>./xbps-src pkg &lt;package1&gt; &lt;package2&gt; ...</code></pre>
<ol start="6" type="1">
<li>Install the built packages:</li>
</ol>
<pre><code>sudo xbps-install --repository /hostdir/binpkgs/ &lt;package1&gt; &lt;package2&gt; ...</code></pre>
<h3 id="running-hyprland">Running Hyprland</h3>
<p>In order to run Hyprland you will need to install some additional
packages which will depend on your setup, for example a <a
href="https://docs.voidlinux.org/config/session-management.html">session
and seat manager</a> and <a
href="https://docs.voidlinux.org/config/graphical-session/graphics-drivers/index.html">graphics
drivers</a>. You may also have to add the user to the
<code>_seatd</code> group. If you use an Nvidia GPU refer to the <a
href="https://wiki.hyprland.org/Nvidia">Hyprland Wiki</a>, but keep in
mind that Hyprland does not officially support Nvidia.</p>
<h3 id="contributing">Contributing</h3>
<p>Contributions are greatly appreciated. Overall, this repository
adheres to the same rules and guidelines as the <a
href="https://github.com/void-linux/void-packages/blob/master/CONTRIBUTING.md">official
void-packages repository</a>. The main difference is that here, you‚Äôre
welcome to add template files for Chromium or Firefox forks if they
provide additional value beyond changing certain settings or
configuration files.</p>
<h3 id="credits">Credits</h3>
<p><a href="https://github.com/Makrennel/hyprland-void">Makrennel:
hyprland-void</a>: Hyprland template files</p>
<p><a
href="https://github.com/Encoded14/void-user-repository">Encoded14:
void-user-repository</a>: Better workflow file and some templates</p>
<p><a href="https://github.com/grvn/void-packages">grvn:
void-packages</a>: various template files</p>
<script>
(function () {
  function hexToRgb(hex) {
    hex = hex.trim().replace(/^#/, '');
    if (hex.length === 3) hex = hex.split('').map(c => c + c).join('');
    const n = parseInt(hex, 16);
    return [n >> 16 & 255, n >> 8 & 255, n & 255];
  }

  function clamp(v, min, max) {
    return Math.min(Math.max(v, min), max);
  }

  function Color(r, g, b) {
    this.r = r / 255;
    this.g = g / 255;
    this.b = b / 255;
  }

  Color.prototype.applyFilter = function (funcs) {
    let [r, g, b] = [this.r * 255, this.g * 255, this.b * 255];

    function multiply(matrix) {
      const nr = clamp(r * matrix[0] + g * matrix[1] + b * matrix[2], 0, 255);
      const ng = clamp(r * matrix[3] + g * matrix[4] + b * matrix[5], 0, 255);
      const nb = clamp(r * matrix[6] + g * matrix[7] + b * matrix[8], 0, 255);
      r = nr; g = ng; b = nb;
    }

    function hueRotate(angle) {
      const a = angle / 180 * Math.PI;
      const sin = Math.sin(a), cos = Math.cos(a);
      multiply([
        0.213 + cos*0.787 - sin*0.213, 0.715 - cos*0.715 - sin*0.715, 0.072 - cos*0.072 + sin*0.928,
        0.213 - cos*0.213 + sin*0.143, 0.715 + cos*0.285 + sin*0.140, 0.072 - cos*0.072 - sin*0.283,
        0.213 - cos*0.213 - sin*0.787, 0.715 - cos*0.715 + sin*0.715, 0.072 + cos*0.928 + sin*0.072,
      ]);
    }

    function sepia(v) {
      multiply([
        0.393 + 0.607*(1-v), 0.769 - 0.769*(1-v), 0.189 - 0.189*(1-v),
        0.349 - 0.349*(1-v), 0.686 + 0.314*(1-v), 0.168 - 0.168*(1-v),
        0.272 - 0.272*(1-v), 0.534 - 0.534*(1-v), 0.131 + 0.869*(1-v),
      ]);
    }

    function saturate(v) {
      multiply([
        0.213 + 0.787*v, 0.715 - 0.715*v, 0.072 - 0.072*v,
        0.213 - 0.213*v, 0.715 + 0.285*v, 0.072 - 0.072*v,
        0.213 - 0.213*v, 0.715 - 0.715*v, 0.072 + 0.928*v,
      ]);
    }

    for (const [fn, val] of funcs) {
      if (fn === 'invert')    { r = clamp((1-r/255)*255*val + r/255*255*(1-val),0,255); g = clamp((1-g/255)*255*val + g/255*255*(1-val),0,255); b = clamp((1-b/255)*255*val + b/255*255*(1-val),0,255); }
      if (fn === 'sepia')     sepia(val);
      if (fn === 'saturate')  saturate(val);
      if (fn === 'hueRotate') hueRotate(val);
      if (fn === 'brightness'){ r = clamp(r*val,0,255); g = clamp(g*val,0,255); b = clamp(b*val,0,255); }
    }

    return new Color(r, g, b);
  };

  function loss(result, target) {
    return (
      Math.pow(result.r*255 - target.r*255, 2) +
      Math.pow(result.g*255 - target.g*255, 2) +
      Math.pow(result.b*255 - target.b*255, 2)
    );
  }

  function solve(target) {
    function css(v) {
      return [
        ['invert',    clamp(v[0], 0, 1)],
        ['sepia',     clamp(v[1], 0, 1)],
        ['saturate',  clamp(v[2], 0, 20)],
        ['hueRotate', clamp(v[3], 0, 360)],
        ['brightness',clamp(v[4], 0, 10)],
        ['brightness',clamp(v[5], 0, 10)],
      ];
    }

    function score(v) {
      return loss(new Color(0,0,0).applyFilter(css(v)), target);
    }

    let best = null, bestScore = Infinity;
    for (let i = 0; i < 30; i++) {
      let v = [Math.random(), Math.random(), Math.random()*10, Math.random()*360, Math.random()*2, Math.random()*2];
      for (let step = 1; step > 0.0001; step *= 0.9) {
        for (let j = 0; j < v.length; j++) {
          const orig = v[j];
          v[j] += step * (Math.random() > 0.5 ? 1 : -1);
          const s = score(v);
          if (s < bestScore) { bestScore = s; best = [...v]; }
          else v[j] = orig;
        }
      }
    }

    const f = css(best);
    return [
      `invert(${(clamp(f[0][1],0,1)*100).toFixed(0)}%)`,
      `sepia(${(clamp(f[1][1],0,1)*100).toFixed(0)}%)`,
      `saturate(${(clamp(f[2][1],0,20)*100).toFixed(0)}%)`,
      `hue-rotate(${clamp(f[3][1],0,360).toFixed(0)}deg)`,
      `brightness(${(clamp(f[4][1],0,10)*100).toFixed(0)}%)`,
      `brightness(${(clamp(f[5][1],0,10)*100).toFixed(0)}%)`,
    ].join(' ');
  }

  // Cache solved filters per color so theme switching is instant
  const cache = {};

  function applyIconColor() {
    const raw = getComputedStyle(document.documentElement)
      .getPropertyValue('--color-icon').trim();
    if (!raw) return false;

    let rgb;
    if (raw.startsWith('#')) {
      rgb = hexToRgb(raw);
    } else if (raw.startsWith('rgb')) {
      rgb = raw.match(/\d+/g).map(Number).slice(0, 3);
    } else {
      return false;
    }

    const key = rgb.join(',');
    if (!cache[key]) {
      cache[key] = solve(new Color(...rgb));
    }

    document.documentElement.style.setProperty('--filter-icon', cache[key]);
    return true;
  }

  function init() {
    if (!applyIconColor()) return;

    // Watch for data-theme attribute changes on <html> ‚Äî re-apply immediately
    new MutationObserver(function(mutations) {
      for (const m of mutations) {
        if (m.attributeName === 'data-theme') {
          applyIconColor();
          break;
        }
      }
    }).observe(document.documentElement, { attributes: true });
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();
</script>
</body>
</html>
