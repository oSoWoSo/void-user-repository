# Template file for 'blocky'
pkgname=blocky
version=0.27.0
revision=1
build_style=go
go_import_path=github.com/0xERR0R/blocky
hostmakedepends="go"
short_desc="DNS proxy as ad-blocker for local network"
maintainer="krum <git@kris.sh>"
license="Apache-2.0"
homepage="https://0xerr0r.github.io/blocky/latest"
changelog="https://github.com/0xERR0R/blocky/releases"
distfiles="https://github.com/0xERR0R/blocky/archive/v${version}.tar.gz"
checksum=c8d333ac554f69a90111dfedbf4d5abce7da97fc54221025a580a5e094ff5d84
# test requires existing docker socket
make_check='no' #extended

system_accounts="_blocky"
_blocky_descr="blocky daemon"

conf_files="/etc/blocky/config.yml"

make_dirs="
	/etc/blocky 0755 _blocky _blocky
	/var/lib/blocky 0700 _blocky _blocky
	/var/log/blocky 0750 _blocky _blocky"

post_install() {
	vsv blocky

	printf "\n" >> config.yml
	vinstall config.yml 644 etc/blocky
}
